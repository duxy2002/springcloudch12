version: '2'
services:
  postgresdb:
    image: busybox
    volumes:
      - /var/lib/postgresql/data

  postgres:
  #  name: postgres
    image: sameersbn/postgresql:9.5-2
    hostname: postgres
    volumes_from:
      - postgresdb
    ports:
     - "5432:5432"
    environment:
      PG_PASSWORD: postgres

  discovery:
    image: "discovery:1.0.0-SNAPSHOT"
    hostname: discovery
  #  name: discovery
    ports:
     - "8761:8761"

  config:
    image: "config:1.0.0-SNAPSHOT"
    hostname: config
  #  name: config
    links:
      - discovery
    environment:
       EUREKA_HOST: discovery
       EUREKA_PORT: 8761
    ports:
      - "8888:8888"

  person:
    image: person:1.0.0-SNAPSHOT
    hostname: person
    links:
      - discovery
      - config
      - postgres
    environment:
       EUREKA_HOST: discovery
       EUREKA_PORT: 8761
       SPRING_PROFILES_ACTIVE: docker
    ports:
      - "8082:8082"

  person2:
    image: person:1.0.0-SNAPSHOT
    mem_limit: 1000000000
    hostname: person2
    links:
      - discovery
      - config
      - postgres
    environment:
       EUREKA_HOST: discovery
       EUREKA_PORT: 8761
       SPRING_PROFILES_ACTIVE: docker
       PERSON_SERVER_PORT: 8081
    ports:
      - "8081:8081"

  some:
    image: some:1.0.0-SNAPSHOT
    hostname: some
    links:
      - discovery
      - config
    environment:
       EUREKA_HOST: discovery
       EUREKA_PORT: 8761
       SPRING_PROFILES_ACTIVE: docker
    ports:
      - "8083:8083"

  some2:
    image: some:1.0.0-SNAPSHOT
    hostname: some2
    links:
      - discovery
      - config
    environment:
       EUREKA_HOST: discovery
       EUREKA_PORT: 8761
       SPRING_PROFILES_ACTIVE: docker
       SOME_SERVER_PORT: 8084
    ports:
      - "8084:8084"

  ui:
    image: ui:1.0.0-SNAPSHOT
    hostname: ui
    links:
      - discovery
      - config
      - person
      - some
    environment:
       EUREKA_HOST: discovery
       EUREKA_PORT: 8761
       SPRING_PROFILES_ACTIVE: docker
    ports:
      - "801:801"

  monitor:
    image: monitor:1.0.0-SNAPSHOT
    hostname: monitor
    links:
      - discovery
      - config
      - person
      - some
      - ui
    environment:
       EUREKA_HOST: discovery
       EUREKA_PORT: 8761
       SPRING_PROFILES_ACTIVE: docker
    ports:
      - "8989:8989"